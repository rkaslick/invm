(this.webpackJsonpInvmogul=this.webpackJsonpInvmogul||[]).push([[58],{1044:function(e,a,t){"use strict";t.r(a);var c=t(4),s=t(17),n=t(9),r=t(0),i=t(1206),o=t(945),l=t(946),d=t(956),p=t(1225),b=t(949),j=t(15),u=t(235),m=t(72),O=(t(112),t(142)),f=t(144),h=t(147),x=t(105),y=t(101),P=t(57),S=t(91),g=t(141),C=(t(646),t(1220)),v=t(233),F=t(381),N=(t(649),t(1222)),M=(t(650),t(125)),I=t(613),T=t.n(I),L=t(285),D=t.n(L),A=t(62),k=t(145),w=t(2),B=["classes"],R={fetchAllTaxes:k.d},q=Object(m.b)((function(e){return{taxList:e.tax.list}}),R)(Object(j.a)((function(e){return{root:{"& .MuiTableCell-head":{fontSize:"0.95rem"}},paper:{margin:e.spacing(-8.9),padding:e.spacing(6)},grid:{paddingLeft:e.spacing(2)}}}))((function(e){var a=e.classes,t=Object(n.a)(e,B),c=Object(r.useRef)();return Object(r.useEffect)((function(){t.fetchAllTaxes()}),[]),Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"ticket",ref:c,children:[Object(w.jsx)("p",{children:"Credit Payment"}),Object(w.jsxs)("p",{className:"centered",children:[" ",t.companyData[0].name,Object(w.jsx)("br",{}),"Phone: ",t.companyData[0].phone,Object(w.jsx)("br",{}),"Address:",t.companyData[0].address,Object(w.jsx)("br",{}),"Reciept No: ",t.paymentInfo.recieptNo,Object(w.jsx)("br",{})," PIN: ",t.companyData[0].krapin,Object(w.jsx)("br",{}),void 0!=t.customerData?"Customer Name:"+t.customerData.name:""]}),Object(w.jsxs)("table",{children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{className:"description",children:" Prev Balance"}),Object(w.jsx)("th",{className:"description",children:"Paid"}),Object(w.jsx)("th",{className:"description",children:"Rem Balance"})]})}),Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{className:"quantity",children:t.paymentInfo.bal}),Object(w.jsx)("td",{className:"description",children:t.paymentInfo.paid}),Object(w.jsx)("td",{className:"price",children:t.paymentInfo.balance})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Paid with"}),Object(w.jsx)("td",{children:t.paymentInfo.payMode}),Object(w.jsx)("td",{})]}),Object(w.jsx)("br",{}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"Total"})})]})]}),Object(w.jsxs)("p",{className:"centered",children:["Thanks for your purchase!",Object(w.jsx)("br",{})]})]}),Object(w.jsx)(T.a,{isHydrating:!0,type:"text/javascript",src:"./print.js"}),Object(w.jsx)(D.a,{trigger:function(){return Object(w.jsx)(A.a.Button,{text:"Print",variant:"outlined",className:a.newButton,onClick:function(){t.setOpenPopup(!1)}})},content:function(){return c.current}})]})})}))),W=t(140),E=t(232),H=t(231),U=t(94),J=t(230),z=t(143),G=t.n(z),V=Object(W.a)((function(e){return{dialogWrapper:{padding:e.spacing(2),position:"absolute",top:e.spacing(5)},DialogTitle:{paddingRight:"0px"}}}));function K(e){var a=e.title,t=e.children,c=e.openCrPopup,s=e.setOpenCrPopup,n=V();return Object(w.jsxs)(E.a,{open:c,maxWidth:"md",clasess:{paper:n.dialogWrapper},children:[Object(w.jsx)(H.a,{className:n.DialogTitle,children:Object(w.jsxs)("div",{style:{display:"flex"},children:[Object(w.jsx)(U.a,{variant:"h6",component:"div",style:{flexGrow:1},children:a}),Object(w.jsx)(A.a.ActionButton,{color:"secondary",onClick:function(){s(!1)},children:Object(w.jsx)(G.a,{})})]})}),Object(w.jsx)(J.a,{dividers:!0,children:t})]})}var Q=t(146),X=t(228),Y=["classes"],Z={payMode:"",customerId:"",balance:0,paid:0,amntPaid:0,userId:0,refNo:""},$={createStockIns:S.c,createStoreProduct:y.b,updateStockIn:S.e,updateStoreProducts:y.e,fetchAllStores:O.d,fetchAllUserLevel:f.d,fetchAllSuppliers:h.d,updateStockInHand:x.f,fetchAllProducts:x.d,fetchAllStoreProduct:y.c,fetchAllStockIn:S.d,fetchByStoreIdNProductId:y.d,updateProducts:x.e,createCreditSale:P.b,createCreditSaleDetails:P.c,fetchAllTransactions:P.e,fetchAllCompanyData:M.d,fetchAllCustomers:Q.d,updateCreditSaleTransaction:P.f,createCreditPay:X.b};a.default=Object(m.b)((function(e){return{addStaffList:e.addStaff.list,storesList:e.stores.list,userLevelList:e.userLevel.list,suppliersList:e.suppliers.list,productsList:e.products.list,storeProductsList:e.storeProducts.list,stockInList:e.stockIns.list,storeIdNProductIdList:e.storeProducts.list,creditSalesList:e.creditSale.list,companyDataList:e.companyData.list,customersList:e.customers.list,payCreditList:e.creditPay.list}}),$)(Object(j.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1),minWidth:230}},formControl:{margin:e.spacing(1),minWidth:230},smMargin:{margin:e.spacing(1)}}}))((function(e){var a=e.classes,t=Object(n.a)(e,Y),j=Object(r.useState)(!1),m=Object(s.a)(j,2),O=m[0],f=m[1],h=Object(g.useToasts)().addToast,x=Object(r.useState)(0),y=Object(s.a)(x,2),P=(y[0],y[1],Object(r.useState)(0)),S=Object(s.a)(P,2),M=(S[0],S[1],Object(r.useState)(0)),I=Object(s.a)(M,2),T=(I[0],I[1],Object(r.useState)({})),L=Object(s.a)(T,2),D=(L[0],L[1],Object(r.useState)(null)),A=Object(s.a)(D,2),k=(A[0],A[1],Object(r.useState)(0)),B=Object(s.a)(k,2),R=(B[0],B[1],Object(r.useState)(0)),W=Object(s.a)(R,2),E=(W[0],W[1],Object(r.useState)(0)),H=Object(s.a)(E,2),U=(H[0],H[1],Object(r.useState)(0)),J=Object(s.a)(U,2),z=(J[0],J[1],Object(r.useState)(!1)),G=Object(s.a)(z,2),V=G[0],Q=G[1],X=Object(r.useState)(!1),$=Object(s.a)(X,2),_=$[0],ee=$[1],ae=Object(r.useState)(0),te=Object(s.a)(ae,2),ce=(te[0],te[1],Object(r.useState)(0)),se=Object(s.a)(ce,2),ne=(se[0],se[1],Object(r.useState)([])),re=Object(s.a)(ne,2),ie=(re[0],re[1],Object(r.useState)(0)),oe=Object(s.a)(ie,2),le=(oe[0],oe[1],Object(r.useState)(0)),de=Object(s.a)(le,2),pe=(de[0],de[1],Object(r.useState)([])),be=Object(s.a)(pe,2),je=(be[0],be[1],Object(r.useState)(0)),ue=Object(s.a)(je,2),me=(ue[0],ue[1],Object(r.useState)("")),Oe=Object(s.a)(me,2),fe=Oe[0],he=Oe[1],xe=Object(r.useState)([]),ye=Object(s.a)(xe,2),Pe=(ye[0],ye[1],Object(r.useState)([])),Se=Object(s.a)(Pe,2),ge=(Se[0],Se[1],Object(r.useState)([])),Ce=Object(s.a)(ge,2),ve=Ce[0],Fe=Ce[1],Ne=Object(r.useState)([]),Me=Object(s.a)(Ne,2),Ie=Me[0],Te=Me[1],Le=Object(r.useState)(null),De=Object(s.a)(Le,2),Ae=De[0],ke=De[1],we=Object(r.useState)(0),Be=Object(s.a)(we,2),Re=(Be[0],Be[1],Object(r.useState)(0)),qe=Object(s.a)(Re,2),We=qe[0],Ee=qe[1],He=Object(r.useState)([]),Ue=Object(s.a)(He,2),Je=Ue[0],ze=Ue[1],Ge=Object(r.useState)([]),Ve=Object(s.a)(Ge,2),Ke=Ve[0],Qe=Ve[1],Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,a=Object(c.a)({},ea);if("customerId"in e&&(a.customerId=e.customerId?"":"This field is required"),"balance"in e&&(a.balance=e.balance?"":"This field is required"),"amntPaid"in e&&(a.amntPaid=e.amntPaid?"":"This field is required"),"payMode"in e&&(a.payMode=e.payMode?"":"This field is required"),aa(Object(c.a)({},a)),e==$e)return Object.values(a).every((function(e){return""==e}))},Ye=Object(u.a)(Z,Xe,t.setCurrentId),Ze=Object(s.a)(Ye,6),$e=Ze[0],_e=Ze[1],ea=Ze[2],aa=Ze[3],ta=Ze[4],ca=(Ze[5],function(){h("Transaction is Successful",{appearance:"success"}),h("Transaction is Successful",{appearance:"success"}),h("Transaction is Successful",{appearance:"success"})}),sa=function(){_e(Object(c.a)({},Z)),Ee(0),ke(null),aa({})};Object(r.useEffect)((function(){if(Ae>0){var e;e=t.creditSalesList.filter((function(e){return e.customerId==Ae&&e.balance>0})),ze(e);var a=t.creditSalesList.reduce((function(e,a){return e+a.balance}),0);Ee(a),$e.customerId=e.customerId,$e.userId=e.userId,Te(t.customersList.find((function(e){return e.id==Ae}))),console.log(t.customersList.find((function(e){return e.id==Ae})))}aa({}),t.fetchAllCompanyData(),t.fetchAllCustomers(),t.fetchAllProducts(),t.fetchAllStockIn(),t.fetchAllTransactions(),Fe(t.companyDataList)}),[Ae]);var na=function(){ee(!0)};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("section",{className:"content",children:Object(w.jsx)("div",{className:"container-fluid",children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-md-12",children:Object(w.jsxs)("div",{className:"card card-primary",children:[Object(w.jsx)("div",{className:"card-header",children:Object(w.jsxs)("h4",{className:"card-title",children:["Pay Credit",Object(w.jsx)("small",{children:" "})]})}),Object(w.jsxs)("form",{id:"quickForm",autoComplete:"off",noValidate:!0,className:a.root,onSubmit:function(e){if(e.preventDefault(),Xe()){var a=function(){ca(),sa()};if("Bank"===$e.payMode||"Mpesa"===$e.payMode)if($e.refNo){var c=$e.amntPaid;console.log($e.amntPaid);for(var s=Je.length,n=0;n<s;n++)console.log(Je[n].balance),Je[n].balance<parseFloat($e.amntPaid)?($e.paid=parseFloat(Je[n].balance),$e.balance=$e.paid-Je[n].balance,$e.amntPaid=$e.amntPaid-$e.paid,console.log($e.balance),console.log(Je[n].transCode+" balance is  less than amount paid "+$e.amntPaid),t.updateCreditSaleTransaction(Je[n].transCode,{paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()})):Je[n].balance===parseFloat($e.amntPaid)?($e.paid=parseFloat(Je[n].balance),$e.balance=parseFloat($e.paid-Je[n].balance),$e.amntPaid=parseFloat($e.amntPaid-$e.paid),console.log($e.balance),console.log(Je[n].transCode+" balance is equal amount paid "+$e.amntPaid),t.updateCreditSaleTransaction(Je[n].transCode,{paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()})):Je[n].balance>parseFloat($e.amntPaid)&&0!==parseFloat($e.amntPaid)&&($e.paid=parseFloat($e.amntPaid),$e.balance=parseFloat(Je[n].balance-$e.paid),$e.amntPaid=parseFloat($e.amntPaid-$e.paid),console.log($e.balance),console.log($e.paid,$e.balance,$e.paid,$e.payMode.toString()),t.updateCreditSaleTransaction(Je[n].transCode,{paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()}));var r="CP-"+Object(N.a)().substring(0,8).toUpperCase(),i={recieptNo:r,bal:parseFloat(We),paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()},o={id:r,amount:parseFloat(c),refNo:$e.refNo,payMode:$e.payMode,customerId:Ae};t.createCreditPay(o),Qe(i),a(),f(!0),sa()}else he("Please enter a refference Number"),na(),ee({onConfirm:function(){}});else if("Cash"===$e.payMode){for(var l=$e.amntPaid,d=Je.length,p=0;p<d;p++)Je[p].balance<parseFloat($e.amntPaid)?($e.paid=parseFloat(Je[p].balance),$e.balance=$e.paid-Je[p].balance,$e.amntPaid=$e.amntPaid-$e.paid,t.updateCreditSaleTransaction(Je[p].transCode,{paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()})):Je[p].balance===parseFloat($e.amntPaid)?($e.paid=parseFloat(Je[p].balance),$e.balance=parseFloat($e.paid-Je[p].balance),$e.amntPaid=parseFloat($e.amntPaid-$e.paid),t.updateCreditSaleTransaction(Je[p].transCode,{paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()})):Je[p].balance>parseFloat($e.amntPaid)&&0!==parseFloat($e.amntPaid)&&($e.paid=parseFloat($e.amntPaid),$e.balance=parseFloat(Je[p].balance-$e.paid),$e.amntPaid=parseFloat($e.amntPaid-$e.paid),t.updateCreditSaleTransaction(Je[p].transCode,{paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()}));var b="CP-"+Object(N.a)().substring(0,8).toUpperCase(),j={recieptNo:b,bal:parseFloat(We),paid:parseFloat($e.paid),balance:parseFloat($e.balance),amnt:parseFloat($e.paid),payMode:$e.payMode.toString()},u={id:b,amount:parseFloat(l),payMode:$e.payMode,customerId:Ae};t.createCreditPay(u),Qe(j),a(),f(!0),sa()}}},children:[Object(w.jsx)(C.a,{className:"form-ctr",sx:{width:30},options:t.customersList,autoHighlight:!0,getOptionLabel:function(e){return e.name},onSelect:ta,onChange:function(e,a){ke(a.id)},renderInput:function(e){return Object(w.jsx)(i.a,Object(c.a)(Object(c.a)({style:{width:"10%"}},e),{},{label:"Choose a Customer",name:"customerId",inputProps:Object(c.a)(Object(c.a)({},e.inputProps),{},{autoComplete:"new-password"}),variant:"outlined",className:"form-ctr",id:"input-with-icon-textfield",value:$e.customerId=Ae,onChange:ta},ea.customerId&&{error:!0,helperText:ea.customerId}))}}),Object(w.jsx)(i.a,Object(c.a)({className:"form-ctr",label:"Balance",name:"balance",value:$e.balance=We,onChange:ta,variant:"outlined"},ea.balance&&{error:!0,helperText:ea.balance})),Object(w.jsx)(i.a,Object(c.a)({className:"form-ctr",label:"Amount To Pay",name:"amntPaid",value:$e.amntPaid,onChange:ta,variant:"outlined"},ea.amntPaid&&{error:!0,helperText:ea.amntPaid})),Object(w.jsxs)(o.a,Object(c.a)(Object(c.a)({className:a.formControl},ea.payMode&&{error:!0}),{},{children:[Object(w.jsx)(l.a,{children:"Payment Mode"}),Object(w.jsxs)(d.a,{className:"form-ctr",label:"Select Payment Mode",name:"payMode",value:$e.payMode,onChange:ta,variant:"outlined",children:[Object(w.jsx)(p.a,{value:"Mpesa",children:"Mpesa"}),Object(w.jsx)(p.a,{value:"Cash",children:"Cash"}),Object(w.jsx)(p.a,{value:"Bank",children:"Bank"})]}),ea.payMode&&Object(w.jsx)(b.a,{children:ea.payMode})]})),Object(w.jsx)(i.a,Object(c.a)({className:"form-ctr",label:"RefrenceNo/MpesaRecieptNo",name:"refNo",value:$e.refNo,onChange:ta,variant:"outlined"},ea.refNo&&{error:!0,helperText:ea.refNo})),Object(w.jsx)("br",{}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{className:"card-footer",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("button",{variant:"contained",type:"submit",className:"btn btn-primary",children:"Pay"}),Object(w.jsx)("button",{variant:"contained",className:"btn btn-secondary",onClick:sa,style:{marginLeft:3},children:"Reset"})]})})]})]})}),Object(w.jsx)("div",{className:"col-md-6"})]})})}),Object(w.jsx)(v.a,{title:"Are you sure you want to remove this product from the cart?",confirmDialog:V,setConfirmDialog:Q}),Object(w.jsx)(F.a,{title:fe,errorDialog:_,setErrorDialog:ee}),Object(w.jsx)(K,{title:"Reciept",openCrPopup:O,setOpenCrPopup:f,children:Object(w.jsx)(q,{customerData:Ie,companyData:ve,paymentInfo:Ke,setOpenCrPopup:f})})]})})))}}]);
//# sourceMappingURL=58.3e0f0cec.chunk.js.map