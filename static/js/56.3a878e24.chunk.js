(this.webpackJsonpInvmogul=this.webpackJsonpInvmogul||[]).push([[56],{1032:function(t,e,c){"use strict";c.r(e);var a,n=c(18),r=c(4),s=c(17),i=c(9),o=c(7),l=c(0),d=c(1218),u=c(1206),j=c(1228),b=c(1213),p=c(15),O=c(235),m=c(72),f=(c(112),c(142)),h=c(144),x=c(147),g=c(105),I=c(101),P=c(57),v=c(91),S=c(141),y=(c(646),c(1215)),C=c(286),L=c.n(C),T=c(1220),N=c(233),q=c(381),k=c(645),D=c.n(k),A=c(644),F=c.n(A),w=(c(649),c(1222)),H=c(385),M=c(382),z=c(125),R=c(146),E=c(198),U=c(196),V=c(1250),J=c(1251),Q=c(1252),W=c(1253),B=c(145),G=c(2),K=["classes"],X=(a={productId:"",supplierId:"",name:"",quantity:"",buyingPrice:"",sellingPrice:"",customPrice:!0,reorderLevel:"",stockInHand:"",mainstorePrice:!0,category:"",size:"",description:"",userId:"1",storeId:"1",totalPrice:"",shells:"",deposit:"",diffShell:"",gTotalPrice:"",totalDeposit:"",gTotal:"",gDeposit:""},Object(o.a)(a,"userId","1"),Object(o.a)(a,"total",""),Object(o.a)(a,"change",0),Object(o.a)(a,"amntPaid",""),Object(o.a)(a,"depVal",0),Object(o.a)(a,"payMode",""),Object(o.a)(a,"customerId",""),Object(o.a)(a,"discount",0),Object(o.a)(a,"discountPrice",0),a),Y={createStockIns:v.c,createStoreProduct:I.b,updateStockIn:v.e,updateStoreProducts:I.e,fetchAllStores:f.d,fetchAllUserLevel:h.d,fetchAllSuppliers:x.d,updateStockInHand:g.f,fetchAllProducts:g.d,fetchAllStoreProduct:I.c,fetchAllStockIn:v.d,fetchByStoreIdNProductId:I.d,updateProducts:g.e,createCreditSale:P.b,createCreditSaleDetails:P.c,fetchAllTransactions:P.e,fetchAllCompanyData:z.d,fetchAllCustomers:R.d,fetchAllDeposit:E.d,fetchAllCategory:U.d,fetchAllTaxes:B.d};e.default=Object(m.b)((function(t){return{addStaffList:t.addStaff.list,storesList:t.stores.list,userLevelList:t.userLevel.list,suppliersList:t.suppliers.list,productsList:t.products.list,storeProductsList:t.storeProducts.list,stockInList:t.stockIns.list,storeIdNProductIdList:t.storeProducts.list,creditSalesList:t.creditSale.list,companyDataList:t.companyData.list,customersList:t.customers.list,depositList:t.deposit.list,categoryList:t.category.list,taxList:t.tax.list}}),Y)(Object(p.a)((function(t){return{root:{"& .MuiTextField-root":{margin:t.spacing(1),minWidth:230}},formControl:{margin:t.spacing(1),minWidth:230},smMargin:{margin:t.spacing(1)}}}))((function(t){var e=t.classes,c=Object(i.a)(t,K),a=Object(l.useState)(!1),o=Object(s.a)(a,2),p=o[0],m=o[1],f=Object(l.useState)(!1),h=Object(s.a)(f,2),x=h[0],g=h[1],I=Object(l.useState)(!1),P=Object(s.a)(I,2),v=P[0],C=P[1],k=Object(S.useToasts)().addToast,A=Object(l.useState)(0),z=Object(s.a)(A,2),R=(z[0],z[1]),E=Object(l.useState)(0),U=Object(s.a)(E,2),B=(U[0],U[1],Object(l.useState)(0)),Y=Object(s.a)(B,2),Z=Y[0],$=Y[1],_=Object(l.useState)({}),tt=Object(s.a)(_,2),et=(tt[0],tt[1],Object(l.useState)(null)),ct=Object(s.a)(et,2),at=(ct[0],ct[1],Object(l.useState)(0)),nt=Object(s.a)(at,2),rt=(nt[0],nt[1],Object(l.useState)(0)),st=Object(s.a)(rt,2),it=(st[0],st[1],Object(l.useState)(0)),ot=Object(s.a)(it,2),lt=(ot[0],ot[1],Object(l.useState)(0)),dt=Object(s.a)(lt,2),ut=(dt[0],dt[1],Object(l.useState)(!1)),jt=Object(s.a)(ut,2),bt=jt[0],pt=jt[1],Ot=Object(l.useState)(!1),mt=Object(s.a)(Ot,2),ft=mt[0],ht=mt[1],xt=Object(l.useState)(0),gt=Object(s.a)(xt,2),It=(gt[0],gt[1],Object(l.useState)(0)),Pt=Object(s.a)(It,2),vt=(Pt[0],Pt[1],Object(l.useState)([])),St=Object(s.a)(vt,2),yt=St[0],Ct=St[1],Lt=Object(l.useState)(0),Tt=Object(s.a)(Lt,2),Nt=(Tt[0],Tt[1],Object(l.useState)(0)),qt=Object(s.a)(Nt,2),kt=(qt[0],qt[1],Object(l.useState)([])),Dt=Object(s.a)(kt,2),At=Dt[0],Ft=Dt[1],wt=Object(l.useState)(0),Ht=Object(s.a)(wt,2),Mt=Ht[0],zt=(Ht[1],Object(l.useState)("")),Rt=Object(s.a)(zt,2),Et=Rt[0],Ut=Rt[1],Vt=Object(l.useState)([]),Jt=Object(s.a)(Vt,2),Qt=Jt[0],Wt=Jt[1],Bt=Object(l.useState)([]),Gt=Object(s.a)(Bt,2),Kt=Gt[0],Xt=Gt[1],Yt=Object(l.useState)([]),Zt=Object(s.a)(Yt,2),$t=Zt[0],_t=Zt[1],te=Object(l.useState)([]),ee=Object(s.a)(te,2),ce=ee[0],ae=ee[1],ne=Object(l.useState)(0),re=Object(s.a)(ne,2),se=re[0],ie=re[1],oe=Object(l.useState)(0),le=Object(s.a)(oe,2),de=(le[0],le[1]),ue=Object(l.useState)(0),je=Object(s.a)(ue,2),be=je[0],pe=je[1],Oe=Object(l.useState)(0),me=Object(s.a)(Oe,2),fe=me[0],he=me[1],xe=Object(l.useState)([]),ge=Object(s.a)(xe,2),Ie=ge[0],Pe=ge[1],ve=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,e=Object(r.a)({},Te);if("quantity"in t&&(e.quantity=t.quantity?"":"This field is required"),"sellingPrice"in t&&(e.sellingPrice=t.sellingPrice?"":"This field is required"),"name"in t&&(e.name=t.name?"":"This field is required"),"customerId"in t&&(e.customerId=t.customerId?"":"This field is required"),Ne(Object(r.a)({},e)),t==Ce)return Object.values(e).every((function(t){return""==t}))},Se=Object(O.a)(X,ve),ye=Object(s.a)(Se,6),Ce=ye[0],Le=ye[1],Te=ye[2],Ne=ye[3],qe=ye[4],ke=(ye[5],function(){k("Transaction is Successful",{appearance:"success"}),k("Transaction is Successful",{appearance:"success"}),k("Transaction is Successful",{appearance:"success"})}),De=function(){Le(Object(r.a)({},X)),Ne({})},Ae=function(t){R(t),$(t)};Object(l.useEffect)((function(){if(c.fetchAllCompanyData(),c.fetchAllCustomers(),c.fetchAllProducts(),c.fetchAllStockIn(),c.fetchAllTransactions(),c.fetchAllDeposit(),c.fetchAllCategory(),c.fetchAllTaxes(),console.log(se),se>0&&de(Object(r.a)({},c.creditSalesList.find((function(t){return t.customerId==se&&t.balance>0})))),0!=c.currentId||0!=Z){Le(Object(r.a)(Object(r.a)({},c.productsList.find((function(t){return t.productId==Z}))),c.storeProductsList.find((function(t){return t.productId==Z}))&&c.storeProductsList.find((function(t){return 2==t.storeId}))));var t=Object(r.a)({},c.productsList.find((function(t){return t.productId==Z})));Fe(t.taxId)}Ne({})}),[Z]);var Fe=function(t){console.log(t);var e=Object(r.a)({},c.taxList.find((function(e){return e.taxId===t})));void 0===e.rate&&(e.rate=0);var a=parseFloat(e.rate/100);he(a)},we=function(){ht(!0)},He=yt.reduce((function(t,e){return t+e.total}),0),Me=(yt.reduce((function(t,e){return t+e.deposit}),0),yt.reduce((function(t,e){return t+e.totalPrice}),0)),ze=yt.reduce((function(t,e){return t+e.quantity}),0),Re=yt.reduce((function(t,e){return t+e.tax}),0),Ee=function(t){for(var e=yt,c=0;c<e.length;c++)if(e[c].productId==t){e.splice(c,1),console.log(c);[].concat(Object(n.a)(yt),[e]);Ct(e)}pt(!1)};return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)("section",{className:"content",children:Object(G.jsx)("div",{className:"container-fluid",children:Object(G.jsxs)("div",{className:"row",children:[Object(G.jsx)("div",{className:"col-md-12",children:Object(G.jsxs)("div",{className:"card card-primary",children:[Object(G.jsx)("div",{className:"card-header",children:Object(G.jsxs)("h4",{className:"card-title",children:["Credit Sale ",Object(G.jsx)("small",{children:" "})]})}),Object(G.jsxs)("form",{id:"quickForm",autoComplete:"off",noValidate:!0,className:e.root,onSubmit:function(t){t.preventDefault();c.categoryList.find((function(t){return t.id==Ce.categoryId}));if(Ce.stockInHand<Ce.quantity&&(console.log(" oops soory "+Ce.stockInHand),Ut("Ooops!! Sorry The requested quantity is not available, Available  stocks is: "+Ce.stockInHand),we(),ht({onConfirm:function(){}}),Ce.quantity=""),Ce.discount>Ce.discountLimit)Ut("Ooops!! Sorry, discount should be below: "+Ce.discountLimit+" KES"),we(),ht({onConfirm:function(){}});else if(ve()){if(Ce.quantity>0){Ce.discount>0?(Ce.discountPrice=parseFloat(Ce.sellingPrice-Ce.discount),Ce.sellingPrice=Ce.discountPrice):Ce.discount=0;var e={productId:Ce.productId,name:Ce.name,size:Ce.size,sellingPrice:Ce.sellingPrice,quantity:parseInt(Ce.quantity),totalPrice:Math.round(parseFloat(Ce.quantity)*parseFloat(Ce.sellingPrice)),discount:parseFloat(Ce.discount),total:parseFloat(Ce.quantity)*parseFloat(Ce.sellingPrice),tax:Math.round(parseFloat(Ce.quantity)*parseFloat(Ce.sellingPrice)*parseFloat(fe))},a={transCode:Mt,productId:Ce.productId,sellingPrice:Ce.sellingPrice,quantity:parseInt(Ce.quantity),totalPrice:Math.round(parseFloat(Ce.quantity)*parseFloat(Ce.sellingPrice)),discount:parseFloat(Ce.discount),total:parseFloat(Ce.quantity)*parseFloat(Ce.sellingPrice),tax:Math.round(parseFloat(Ce.quantity)*parseFloat(Ce.sellingPrice)*parseFloat(fe))},r=[].concat(Object(n.a)(yt),[e]),s=[].concat(Object(n.a)(At),[a]);Ct(r),Ft(s),De()}else Ut("Please specify quantity and no of shells"),we(),ht({onConfirm:function(){}})}},children:[Object(G.jsxs)(d.a,{container:!0,children:[Object(G.jsxs)(d.a,{item:!0,xs:2.5,children:[Object(G.jsx)(T.a,{className:"form-ctr",sx:{width:30},options:c.customersList,autoHighlight:!0,getOptionLabel:function(t){return t.name},onSelect:qe,onChange:function(t,e){ie(e.id),ae(Object(r.a)({},c.customersList.find((function(t){return t.id==e.id}))))},renderInput:function(t){return Object(G.jsx)(u.a,Object(r.a)(Object(r.a)({style:{width:"10%"}},t),{},{label:"Choose a Customer",name:"customerId",inputProps:Object(r.a)(Object(r.a)({},t.inputProps),{},{autoComplete:"new-password"}),variant:"outlined",className:"form-ctr",id:"input-with-icon-textfield",value:Ce.customerId=se,onChange:qe},Te.customerId&&{error:!0,helperText:Te.customerId}))}}),Object(G.jsx)(d.a,{children:Object(G.jsx)(T.a,{className:"form-ctr",sx:{width:30},options:Ie,autoHighlight:!0,getOptionLabel:function(t){return t.size},onSelect:qe,onChange:function(t,e){pe(e.productId),Ae(e.productId)},renderInput:function(t){return Object(G.jsx)(u.a,Object(r.a)(Object(r.a)({style:{width:"10%"}},t),{},{label:"Select a Size",name:"productId",inputProps:Object(r.a)(Object(r.a)({},t.inputProps),{},{autoComplete:"new-password"}),variant:"outlined",className:"form-ctr",id:"input-with-icon-textfield",value:Ce.productId=be,onChange:qe},Te.size&&{error:!0,helperText:Te.size}))}})})]}),Object(G.jsx)(d.a,{item:!0,xs:2.5,children:Object(G.jsx)(T.a,{className:"form-ctr",sx:{width:30},options:c.productsList,autoHighlight:!0,getOptionLabel:function(t){return t.name},onSelect:qe,onChange:function(t,e){var a;pe(e.productId),Ae(e.productId),a=e.name,Pe(Object(n.a)(c.productsList.filter((function(t){return t.name===a}))))},renderInput:function(t){return Object(G.jsx)(u.a,Object(r.a)(Object(r.a)({style:{width:"10%"}},t),{},{label:"Select a product",name:"productId",inputProps:Object(r.a)(Object(r.a)({},t.inputProps),{},{autoComplete:"new-password"}),variant:"outlined",className:"form-ctr",id:"input-with-icon-textfield",value:Ce.productId=be,onChange:qe},Te.productId&&{error:!0,helperText:Te.productId}))}})})]}),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",id:"input-with-icon-textfield",variant:"outlined",type:"text",name:"productId",label:"Product Code",InputLabelProps:{startAdornment:Object(G.jsx)(y.a,{position:"start",children:Object(G.jsx)(L.a,{})})},value:Ce.productId,onChange:function(){var t=Object(r.a)({},c.productsList.find((function(t){return t.productId==Z}))),e=t.markup,a=t.buyingPrice,n=a+e/100*a,s=10*Math.ceil(n/10);0===t.markup&&void 0===t.markup||(Ce.sellingPrice=s),console.log(t.markup),Le({name:t.name,sellingPrice:Ce.sellingPrice,stockInHand:t.stockInHand,discountLimit:t.discountLimit})}},Te.productId&&{error:!0,helperText:Te.productId})),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",name:"sellingPrice",label:"Unit Price",value:Ce.sellingPrice,onChange:qe,variant:"outlined"},Te.sellingPrice&&{error:!0,helperText:Te.sellingPrice})),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",name:"quantity",label:"Quantity",value:Ce.quantity,onChange:qe,variant:"outlined"},Te.quantity&&{error:!0,helperText:Te.quantity})),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",name:"discount",label:"Discount",value:Ce.discount,onChange:qe,variant:"outlined"},Te.discount&&{error:!0,helperText:Te.discount})),Object(G.jsx)("br",{}),Object(G.jsx)("br",{}),Object(G.jsx)("div",{className:"card-footer",children:Object(G.jsx)("div",{children:Object(G.jsx)("button",{variant:"contained",type:"submit",className:"btn btn-primary",children:"Add To Cart"})})})]}),Object(G.jsxs)("form",{id:"quickForm",autoComplete:"off",noValidate:!0,className:e.root,onSubmit:function(t){if(t.preventDefault(),0!=He){var e={transCode:"CS-"+Object(w.a)().substring(0,8).toUpperCase(),customerId:Ce.customerId,totalPrice:Me,gTotal:He,quantity:ze,amnt:parseFloat(He),balance:parseFloat(He),userId:window.userId.toString(),totalTax:Re};At.forEach((function(t){t.transCode=e.transCode,c.createCreditSaleDetails(t);var a=c.productsList.find((function(e){return e.productId==t.productId})),n=parseInt(a.stockInHand)-parseInt(t.quantity);c.updateStockInHand(t.productId,{stockInHand:n}),console.log(t)})),c.createCreditSale(e,(function(){ke(),De()})),console.log(e),m(!0),Wt(yt),Xt(e),_t(c.companyDataList),ae(c.customersList),De(),Ct([])}else Ut("Please choose products for sale."),we(),ht({onConfirm:function(){}})},children:[Object(G.jsx)("div",{className:e.grid,children:Object(G.jsxs)("table",{class:"table .table-responsive{-sm|-md|-lg|-xl|-xxl} table-bordered table-hover table-sm table-striped",children:[Object(G.jsx)("thead",{class:"thead-dark",children:Object(G.jsxs)("tr",{children:[Object(G.jsx)("th",{scope:"col",children:"Name"}),Object(G.jsx)("th",{scope:"col",children:"Unit Price"}),Object(G.jsx)("th",{scope:"col",children:"Quantity"}),Object(G.jsx)("th",{scope:"col",children:"Discount"}),Object(G.jsx)("th",{scope:"col",children:"Total Price"}),Object(G.jsx)("th",{scope:"col",children:"Total"}),Object(G.jsx)("th",{})]})}),Object(G.jsx)("tbody",{children:yt.map((function(t){return Object(G.jsxs)("tr",{children:[Object(G.jsx)("td",{children:t.name}),Object(G.jsx)("td",{children:t.sellingPrice}),Object(G.jsx)("td",{children:t.quantity}),Object(G.jsx)("td",{children:t.discount}),Object(G.jsx)("td",{children:t.totalPrice}),Object(G.jsx)("td",{children:t.total}),Object(G.jsx)("td",{children:Object(G.jsxs)(j.a,{variant:"text",children:[Object(G.jsx)(b.a,{children:Object(G.jsx)(D.a,{color:"primary",onClick:function(){!function(t){Le(Object(r.a)({},yt.find((function(e){return e.productId==t})))),Ee(t)}(t.productId)}})}),Object(G.jsx)(b.a,{children:Object(G.jsx)(F.a,{color:"Secondary",onClick:function(){pt(!0),pt({onConfirm:function(){Ee(t.productId)}})}})})]})})]})}))})]})}),Object(G.jsx)("br",{}),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",name:"total",label:"Total Price",value:Me,onChange:qe,variant:"outlined"},Te.gTotalPrice&&{error:!0,helperText:Te.gTotalPrice})),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",name:"grandTotal",label:"Grand Total",value:He,onChange:qe,variant:"outlined"},Te.gTotal&&{error:!0,helperText:Te.gTotal})),Object(G.jsx)(u.a,Object(r.a)({className:"form-ctr",name:"amntPaid",label:"Amount Paid",value:He,onChange:qe,variant:"outlined"},Te.amntPaid&&{error:!0,helperText:Te.amntPaid})),Object(G.jsx)("div",{className:"card-footer",children:Object(G.jsx)("div",{children:Object(G.jsx)("button",{variant:"contained",type:"submit",className:"btn btn-primary",children:"Credit"})})})]}),Object(G.jsx)("div",{className:"card-footer",children:Object(G.jsxs)("div",{children:[Object(G.jsx)("button",{variant:"contained",className:"btn btn-primary",onClick:function(){g(!0)},children:"Print Invoice"}),Object(G.jsx)("button",{variant:"contained",className:"btn btn-primary",style:{marginLeft:5},onClick:function(){C(!0)},children:"Print Delivery Note"})]})})]})}),Object(G.jsx)("div",{className:"col-md-6"})]})})}),Object(G.jsx)(N.a,{title:"Are you sure you want to remove this product from the cart?",confirmDialog:bt,setConfirmDialog:pt}),Object(G.jsx)(q.a,{title:Et,errorDialog:ft,setErrorDialog:ht}),Object(G.jsx)(M.a,{title:"Reciept",openRPopup:p,setOpenRPopup:m,children:Object(G.jsx)(H.a,{customerData:ce,companyData:$t,trans:Kt,recordList:Qt,setRecordList:Wt,setOpenRPopup:m,totalTax:Re})}),Object(G.jsx)(J.a,{title:"Invoice",openIPopup:x,setOpenIPopup:g,children:Object(G.jsx)(V.a,{products:yt,setOpenIPopup:g,gTotalPrice:Me,customerData:ce,totalTax:Re})}),Object(G.jsx)(Q.a,{title:"Delivery Note",openDlPopup:v,setOpenDlPopup:C,children:Object(G.jsx)(W.a,{products:yt,setOpenDlPopup:C,gTotalPrice:Me,totalTax:Re})})]})})))}}]);
//# sourceMappingURL=56.3a878e24.chunk.js.map